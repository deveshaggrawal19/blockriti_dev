var apg=function(e){function t(){n("/startTransaction",{apiPublic:e.apiPublic,amount:e.amountSatoshis,info:e.info,confirmedCallback:e.confirmedCallback},function(t){function a(){n("/getTransactionInfo",{txId:t.txId},function(t){document.getElementById("apg-received").textContent=(t.paidAmount/1e8).toFixed(8),"unconfirmed"!==t.state&&"complete"!==t.state||e.jsCallback()})}e.elt.innerHTML+='<img src="'+t.qr+'" style="float: left">',e.elt.innerHTML+="<br>",e.elt.innerHTML+="Send <strong>"+(e.amountSatoshis/1e8).toFixed(8)+" BTC</strong> to <strong>"+t.address+"</strong>",e.elt.innerHTML+="<br>",e.elt.innerHTML+='Received: <strong><span id="apg-received">0.00000000</span> BTC</strong>',e.elt.innerHTML+="<br>",e.elt.innerHTML+="Or pay with prepaid card:",e.elt.innerHTML+="<br>",e.elt.innerHTML+='<input style="margin:10px;font-size:14pt" id="apg-card-num" placeholder="card number"><input style="margin:10px;font-size:14pt" id="apg-pin" type="number" placeholder="pin"><button style="font-size:14pt" id="apg-prepaid">Pay</button>',e.elt.style.cssText="height:200px;line-height:1.5rem;margin:10px;width:40vw;border:10px solid #bbb;",document.getElementById("apg-prepaid").addEventListener("click",function(){confirm("Pay "+e.amountSatoshis/1e8+" BTC with prepaid card?")&&n("/payWithPrepaid",{txId:t.txId,cardNum:document.getElementById("apg-card-num").value,pin:document.getElementById("apg-pin").value},function(e){if("error"===e.status)switch(e.message){case"Invalid card/pin":alert("Incorrect card number/pin");break;case"Insufficient funds":alert("Insufficient funds to pay with prepaid");break;default:alert("Error paying with prepaid card: "+e.message)}else alert("Payment completed successfully"),a()})}),setInterval(a,5e3)})}var n=function(e,t,n){var a=new XMLHttpRequest;a.open("POST","https://shrikantbhalerao.com/gateway"+e),a.setRequestHeader("Content-Type","application/json"),a.responseType="json",a.send(JSON.stringify(t)),a.onload=function(){n(a.response)}};if(!["elt","apiPublic","info","jsCallback","confirmedCallback"].every(function(t){return~Object.keys(e).indexOf(t)})||!e.amountSatoshis&&!e.amountInr)throw new Error("You must provide elt, apiPublic, info, jsCallback, confirmedCallback, and either amountSatoshis or amountInr as parameters to `apg`");if(console.log(e.amountInr),e.amountInr){var a=new XMLHttpRequest;a.open("GET","http://1-dot-blockriti-163505.appspot.com/api/brokerage"),a.responseType="json",a.send(),a.onload=function(){e.amountSatoshis=e.amountInr/a.response.sell*1e8,t()}}else t()};
